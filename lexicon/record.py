from math import sqrt

record_lexicon = {
    "direct_help_message": (
        "üìè *–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä—è–º—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π*\n\n"
        "–ß—Ç–æ–±—ã —è —Ä–∞—Å—Å—á–∏—Ç–∞–ª –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ *—Ç—Ä—ë—Ö —Å—Ç—Ä–æ–∫–∞—Ö*:\n\n"
        "1Ô∏è‚É£ *–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π* (—á–∏—Å–ª–æ)\n"
        "2Ô∏è‚É£ *–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π* (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)\n"
        "3Ô∏è‚É£ *–ü—Ä–∏–±–æ—Ä–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å* (—á–∏—Å–ª–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, 0.1)\n\n"
        "‚ú® *–§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:*\n"
        "```\n"
        "5\n"
        "10.5, 10.7, 10.4, 10.6, 10.5\n"
        "0.1\n"
        "```\n"
        "üí° *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –ï—Å–ª–∏ –ø—Ä–∏–±–æ—Ä–Ω–æ–π –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ –Ω–µ—Ç, –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–µ –¥–≤–µ —Å—Ç—Ä–æ–∫–∏.\n\n"
        "–Ø –æ—Ñ–æ—Ä–º–ª—é –ø–æ–ª–Ω—ã–π —Ä–∞—Å—á—ë—Ç —Å –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏, –≥–æ—Ç–æ–≤—ã–π –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—É—é —Ä–∞–±–æ—Ç—É."
    ),
    "indirect_help_message": (
        "üîÅ *–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ—Å–≤–µ–Ω–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π (–º–µ—Ç–æ–¥ –≤—ã–±–æ—Ä–æ–∫)*\n\n"
        "–î–ª—è —Ä–∞—Å—á—ë—Ç–∞ –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ *–¥–≤—É—Ö —á–∞—Å—Ç—è—Ö*:\n\n"
        "üßÆ *–ß–∞—Å—Ç—å 1: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á—ë—Ç–æ–≤*\n"
        "‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–∏ (n)\n"
        "‚Ä¢ –ó–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Ä–∏–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)\n\n"
        "üìê *–ß–∞—Å—Ç—å 2: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–ª–Ω–æ–π –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏*\n"
        "‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–≤–∏—Å–∏—Ç —Ñ—É–Ω–∫—Ü–∏—è (m)\n"
        "‚Ä¢ –î–ª—è *–∫–∞–∂–¥–æ–π* –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —É–∫–∞–∂–∏—Ç–µ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏:\n"
        "  `[—á–∞—Å—Ç–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è], [–ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å —ç—Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π]`\n\n"
        "‚ú® *–ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:*\n"
        "```\n"
        "5\n"
        "2.15, 2.20, 2.18, 2.22, 2.17\n"
        "2\n"
        "0.5, 0.02\n"
        "2.0, 0.1\n"
        "```\n"
        "*–†–∞–∑–±–æ—Ä –ø—Ä–∏–º–µ—Ä–∞:*\n"
        "‚Ä¢ –†–∞—Å—Å—á–∏—Ç–∞–Ω–æ 5 –∑–Ω–∞—á–µ–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–∏ `f`: 2.15, 2.20, ...\n"
        "‚Ä¢ –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç 2 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `x` –∏ `y`).\n"
        "‚Ä¢ –°—Ç—Ä–æ–∫–∞ `0.5, 0.02` –æ–∑–Ω–∞—á–∞–µ—Ç: ‚àÇf/‚àÇx = 0.5, –∞ Œîx = 0.02.\n"
        "‚Ä¢ –°—Ç—Ä–æ–∫–∞ `2.0, 0.1` –æ–∑–Ω–∞—á–∞–µ—Ç: ‚àÇf/‚àÇy = 2.0, –∞ Œîy = 0.1.\n\n"
        "–Ø –≤—ã—á–∏—Å–ª—é —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –µ—ë –ø–æ–ª–Ω—É—é –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å, –æ—Ñ–æ—Ä–º–∏–≤ –≤—Å—ë –≤ –≤–∏–¥–µ –æ—Ç—á—ë—Ç–∞."
    )


}



def get_avarage_message(record_count: int, records: list[float], result: float) -> str:
    return (
        "üìä **–†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ**\n\n"
        
        "**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**\n"
        f"‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π: `{record_count}`\n"
        f"‚Ä¢ –ó–Ω–∞—á–µ–Ω–∏—è: `{', '.join(f'{x}' for x in records)}`\n\n"
        
        "**–§–æ—Ä–º—É–ª–∞:**\n"
        "```\n"
        f"xÃÑ = (‚àëx·µ¢) / n\n"
        f"   = ({' + '.join(f'{x}' for x in records)}) / {record_count}\n"
        "```\n\n"
        
        "**–í—ã—á–∏—Å–ª–µ–Ω–∏—è:**\n"
        f"‚Ä¢ –°—É–º–º–∞: `{sum(records)}`\n"
        f"‚Ä¢ –î–µ–ª–µ–Ω–∏–µ –Ω–∞ `{record_count}`\n\n"
        
        "üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**\n"
        f"```\n"
        f"xÃÑ = {result:.6f}\n"
        "```"
    )

def get_rms_message(record_count: int, avarage: float, sum_squared: float, result: float):
    return (
        "üìà **–†–∞—Å—á–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (–°–ö–û)**\n\n"
        
        "**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**\n"
        f"‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π: `{record_count}`\n"
        f"‚Ä¢ –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: `{avarage:.6f}`\n\n"
        
        "**–§–æ—Ä–º—É–ª–∞:**\n"
        "```\n"
        "œÉ = ‚àö[‚àë(x·µ¢ - xÃÑ)¬≤ / (n-1)]\n"
        "```\n\n"
        
        f"\n**–°—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤:** `{sum_squared:.6f}`\n"
        f"**–î–µ–ª–µ–Ω–∏–µ –Ω–∞ (n-1):** `{sum_squared:.6f} / {record_count-1} = {sum_squared/(record_count-1):.6f}`\n"
        f"**–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ—Ä–Ω—è:** `‚àö{sum_squared/(record_count-1):.6f}`\n\n"
        
        "üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**\n"
        f"```\n"
        f"œÉ = {result:.6f}\n"
        "```"
    )

def get_rmsm_message(record_count: int, s: float, result: float):
    return (
        "üéØ **–†–∞—Å—á–µ—Ç –°–ö–û —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**\n\n"
        
        "**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**\n"
        f"‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π: `{record_count}`\n"
        f"‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: `{s:.6f}`\n\n"
        
        "**–§–æ—Ä–º—É–ª–∞:**\n"
        "```\n"
        f"s‚Çì = œÉ / ‚àön\n"
        f"   = {s:.6f} / ‚àö{record_count}\n"
        "```\n\n"
        
        "**–í—ã—á–∏—Å–ª–µ–Ω–∏—è:**\n"
        f"‚Ä¢ ‚àö{record_count} = `{sqrt(record_count):.6f}`\n"
        f"‚Ä¢ {s:.6f} / {sqrt(record_count):.6f} = `{result:.6f}`\n\n"
        
        "üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:**\n"
        f"```\n"
        f"s‚Çì = {result:.6f}\n"
        "```\n\n"
        "*–°–ö–û —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è*"
    )


def get_tpn_message(record_count: int, result: float) -> str:
    return (
        "üìä **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°—Ç—å—é–¥–µ–Ω—Ç–∞**\n\n"
        
        "**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**\n"
        f"‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π: `{record_count}`\n"
        f"‚Ä¢ –£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è: `95%`\n"
        f"‚Ä¢ –ß–∏—Å–ª–æ —Å—Ç–µ–ø–µ–Ω–µ–π —Å–≤–æ–±–æ–¥—ã: `{record_count - 1}`\n\n"
        
        "**–†–µ–∑—É–ª—å—Ç–∞—Ç:**\n"
        f"```\n"
        f"t‚Çç‚ÇÄ.‚Çâ‚ÇÖ, {record_count-1}‚Çé = {result}\n"
        "```\n\n"
        
    )

def get_error_rate_message(instrument_err_rate: float, tpn: float, s_: float ,result: float) -> str:
    return (
        "üî¨ *–†–∞—Å—á–µ—Ç –ø–æ–ª–Ω–æ–π –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏*\n\n"
        
        "*–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:*\n"
        f"‚Ä¢ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°—Ç—å—é–¥–µ–Ω—Ç–∞ (t‚Çö,‚Çô): `{tpn:.4f}`\n"
        f"‚Ä¢ –°–ö–û —Å—Ä–µ–¥–Ω–µ–≥–æ (s): `{s_:.6f}`\n"
        f"‚Ä¢ –ü—Ä–∏–±–æ—Ä–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å (Œò): `{instrument_err_rate:.6f}`\n\n"
        
        "*–§–æ—Ä–º—É–ª–∞:*\n"
        "```\n"
        "Œî = ‚àö[(t‚Çö,‚Çô √ó s)¬≤ + Œò¬≤]\n"
        "```\n\n"
        
        "*–í—ã—á–∏—Å–ª–µ–Ω–∏–µ:*\n"
        f"1. t‚Çö,‚Çô √ó s = `{tpn:.4f} √ó {s_:.6f} = {tpn * s_:.6f}`\n"
        f"2. (t‚Çö,‚Çô √ó s)¬≤ = `({tpn * s_:.6f})¬≤ = {(tpn * s_) ** 2:.8f}`\n"
        f"3. Œò¬≤ = `({instrument_err_rate:.6f})¬≤ = {instrument_err_rate ** 2:.8f}`\n"
        f"4. –°—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ = `{(tpn * s_) ** 2:.8f} + {instrument_err_rate ** 2:.8f} = {((tpn * s_) ** 2) + (instrument_err_rate ** 2):.8f}`\n"
        f"5. ‚àö(—Å—É–º–º—ã) = `‚àö{((tpn * s_) ** 2) + (instrument_err_rate ** 2):.8f} = {result:.6f}`\n\n"
        
        f"üìä *–ü–æ–ª–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å: Œî = {result:.6f}*"
    )


def get_result_message(value: float, erate: float, rounded_erate: float, rounded_value: float) -> str:
    return (
        "## üéØ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞\n\n"
        
        "### –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n"
        f"- **–°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: `{value:.8f}`\n"
        f"- **–ü–æ–ª–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å**: `{erate:.8f}`\n\n"
        
        "### –ü—Ä–æ—Ü–µ—Å—Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è:\n"
        f"1. **–ê–Ω–∞–ª–∏–∑ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏**: `{erate:.6f}`\n"
        f"2. **–ü–µ—Ä–≤–∞—è –∑–Ω–∞—á–∞—â–∞—è —Ü–∏—Ñ—Ä–∞**: `{rounded_erate}`\n"
        f"3. **–û–∫—Ä—É–≥–ª–µ–Ω–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ**: `{value:.6f}` ‚Üí `{rounded_value}`\n"
        f"4. **–û–∫—Ä—É–≥–ª–µ–Ω–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å**: `{erate:.6f}` ‚Üí `{rounded_erate}`\n\n"
        
        "### üìä –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:\n"
        "```\n"
        f"x = ({rounded_value} ¬± {rounded_erate}) –µ–¥. –∏–∑–º.\n"
        "```\n\n"
        
    )
def get_indirect_erate_message(diff_count: int, diff_and_erate: list, erate: float) -> str:
    squares_sum = erate ** 2
    
    return (
        "## üîç –†–∞—Å—á–µ—Ç –ø–æ–ª–Ω–æ–π –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏\n\n"
        
        "### –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n"
        f"- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**: `{diff_count}`\n\n"
        
        "### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏:\n"
        f"{''.join(f'- **‚àÇf/‚àÇx{i+1}√óŒîx{i+1}**: `{diff:.4f}√ó{partial_erate:.4f} = {diff*partial_erate:.6f}`\n' for i, (diff, partial_erate) in enumerate(diff_and_erate))}\n"
        
        "### –ü—Ä–æ—Ü–µ—Å—Å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π:\n"
        "**–§–æ—Ä–º—É–ª–∞**: `Œîf = ‚àö[Œ£(‚àÇf/‚àÇx·µ¢ √ó Œîx·µ¢)¬≤]`\n\n"
        "**–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤**:\n"
        f"{''.join(f'- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç {i+1}: `({diff*partial_erate:.6f})¬≤ = {(diff*partial_erate)**2:.8f}`\n' for i, (diff, partial_erate) in enumerate(diff_and_erate))}"
        f"- **–°—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤**: `{squares_sum:.8f}`\n"
        f"- **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ—Ä–Ω—è**: `‚àö{squares_sum:.8f} = {erate:.8f}`\n\n"
        
        "### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏:\n"
        f"**–ü–æ–ª–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å**: `Œîf = {erate:.8f}`\n\n"
    )